def update_actual_values(self, karakterler: List[TeknikResimKarakteri]) -> bool:
        """Word tablosundaki ACTUAL kolonunu gÃ¼nceller (tolerans kontrolÃ¼ ve uygunsuz iÅŸaretleme ile)"""
        if not self.current_document:
            print("HATA: Ã–nce Word dosyasÄ± yÃ¼klenmelidir")
            return False
        
        try:
            print("ACTUAL deÄŸerleri Word tablosuna yazÄ±lÄ±yor (tolerans kontrolÃ¼ ve uygunsuz iÅŸaretleme ile)...")
            
            # Karakterleri item_no ile hÄ±zlÄ± eriÅŸim iÃ§in dict'e Ã§evir
            karakter_dict = {k.item_no: k for k in karakterler}
            updated_count = 0
            tolerance_violations = 0
            unsuitable_markings = 0
            
            for table_idx, table in enumerate(self.current_document.tables):
                print(f"  Tablo {table_idx + 1} kontrol ediliyor...")
                
                # Kolon indekslerini bul
                item_no_col_index, actual_col_index = self.find_table_columns(table)
                
                if actual_col_index is None:
                    print(f"    Tablo {table_idx + 1}'de ACTUAL kolonu bulunamadÄ±")
                    continue
                
                if item_no_col_index is None:
                    print(f"    Tablo {table_idx + 1}'de ITEM NO kolonu bulunamadÄ±")
                    continue
                
                print(f"    ITEM NO kolonu: {item_no_col_index}, ACTUAL kolonu: {actual_col_index}")
                
                # Veri satÄ±rlarÄ±nÄ± gÃ¼ncelle (header'Ä± atla)
                for row_idx, row in enumerate(table.rows[1:], start=1):
                    try:
                        # GÃ¼venlik kontrolÃ¼ - yeterli hÃ¼cre var mÄ±?
                        if len(row.cells) <= max(item_no_col_index, actual_col_index):
                            print(f"    âš  SatÄ±r {row_idx}: Yeterli hÃ¼cre yok ({len(row.cells)} hÃ¼cre)")
                            continue
                        
                        # ITEM NO'yu al
                        item_no_cell = row.cells[item_no_col_index]
                        item_no = item_no_cell.text.strip()
                        
                        # Bu ITEM NO'ya sahip karakter var mÄ± ve actual deÄŸeri var mÄ±?
                        if item_no in karakter_dict:
                            karakter = karakter_dict[item_no]
                            
                            if karakter.actual:
                                # ACTUAL hÃ¼cresini gÃ¼ncelle
                                actual_cell = row.cells[actual_col_index]
                                actual_value = str(karakter.actual)
                                
                                # Ã–nce uygunsuz iÅŸaretleme kontrolÃ¼
                                if karakter.is_out_of_tolerance:
                                    # Uygunsuz iÅŸaretli - kÄ±rmÄ±zÄ± arka plan yap
                                    success = self.apply_red_background(actual_cell, actual_value)
                                    unsuitable_markings += 1
                                    format_type = "kÄ±rmÄ±zÄ± arka plan (uygunsuz)"
                                    print(f"    âŒ {item_no}: {actual_value} (Uygunsuz iÅŸaretli - {format_type})")
                                    
                                else:
                                    # Normal tolerans kontrolÃ¼ yap
                                    tolerance_results, tolerance_status = self.check_multiple_values_tolerance(actual_value, karakter)
                                    
                                    if tolerance_results:
                                        # En az bir deÄŸer var
                                        any_out_of_tolerance = not all(tolerance_results)
                                        
                                        if any_out_of_tolerance:
                                            # Tolerans dÄ±ÅŸÄ± deÄŸer(ler) var - sarÄ± highlight uygula
                                            success = self.format_tolerance_violation(actual_cell, actual_value, tolerance_results)
                                            
                                            tolerance_violations += 1
                                            format_type = "sarÄ± highlight"
                                            print(f"    ğŸŸ¡ {item_no}: {actual_value} (Tolerans dÄ±ÅŸÄ± - {format_type})")
                                            print(f"      ğŸ“Š {tolerance_status}")
                                        else:
                                            # TÃ¼m deÄŸerler tolerans iÃ§inde - normal yaz
                                            actual_cell.text = actual_value
                                            print(f"    âœ… {item_no}: {actual_value} (Tolerans iÃ§inde)")
                                    else:
                                        # Tolerans kontrolÃ¼ yapÄ±lamadÄ± - normal yaz
                                        actual_cell.text = actual_value
                                        print(f"    â—‹ {item_no}: {actual_value} (Tolerans kontrol edilemedi)")
                                
                                updated_count += 1
                            else:
                                print(f"    â—‹ {item_no}: Ã–lÃ§Ã¼m deÄŸeri yok")
                        else:
                            # ITEM NO bulunamadÄ± - sadece debug iÃ§in yazdÄ±r
                            if item_no and item_no.upper().startswith('KN'):
                                print(f"    ? {item_no}: Karakterler listesinde bulunamadÄ±")
                                
                    except Exception as e:
                        print(f"    âœ— SatÄ±r {row_idx} gÃ¼ncellenirken hata: {e}")
                        continue
            
            print(f"âœ“ Toplam {updated_count} ACTUAL deÄŸeri gÃ¼ncellendi")
            if tolerance_violations > 0:
                print(f"ğŸŸ¡ {tolerance_violations} tolerans dÄ±ÅŸÄ± deÄŸer sarÄ± highlight ile iÅŸaretlendi")
            if unsuitable_markings > 0:
                print(f"âŒ {unsuitable_markings} uygunsuz deÄŸer kÄ±rmÄ±zÄ± arka plan ile iÅŸaretlendi")
            
            return updated_count > 0
            
        except Exception as e:
            print(f"HATA: ACTUAL deÄŸerleri gÃ¼ncellenirken hata: {e}")
            return False

    def apply_red_background(self, cell, text: str) -> bool:
        """
        Uygunsuz iÅŸaretli deÄŸerler iÃ§in kÄ±rmÄ±zÄ± arka plan uygular
        """
        try:
            # Metni yaz
            cell.text = text
            
            # HÃ¼cre arka planÄ±nÄ± kÄ±rmÄ±zÄ± yap
            tc_pr = cell._tc.get_or_add_tcPr()
            
            # Eski shading'i kaldÄ±r
            for shading in tc_pr.findall(qn('w:shd')):
                tc_pr.remove(shading)
            
            # KÄ±rmÄ±zÄ± arka plan ekle
            shading_elm = OxmlElement(qn('w:shd'))
            shading_elm.set(qn('w:val'), 'clear')
            shading_elm.set(qn('w:color'), 'auto')
            shading_elm.set(qn('w:fill'), 'FF6666')  # AÃ§Ä±k kÄ±rmÄ±zÄ±
            
            tc_pr.append(shading_elm)
            
            # Metni de beyaz yap (kontrast iÃ§in)
            paragraph = cell.paragraphs[0]
            if paragraph.runs:
                for run in paragraph.runs:
                    run.font.color.rgb = RGBColor(255, 255, 255)  # Beyaz
            
            print(f"      ğŸ”´ HÃ¼cre kÄ±rmÄ±zÄ± arka plan yapÄ±ldÄ±: {text}")
            return True
            
        except Exception as e:
            print(f"      âš  KÄ±rmÄ±zÄ± arka plan hatasÄ±: {e}")
            # Fallback: Sadece metni yaz
            cell.text = text
            return False

    def get_statistics(self, karakterler: List[TeknikResimKarakteri]) -> dict:
        """Ã–lÃ§Ã¼m istatistiklerini dÃ¶ner (uygunsuz iÅŸaretleme dahil)"""
        total = len(karakterler)
        measured = len([k for k in karakterler if k.actual])
        unmeasured = total - measured
        
        # Tolerans istatistikleri
        tolerance_violations = 0
        tolerance_compliant = 0
        no_tolerance_defined = 0
        unsuitable_markings = len([k for k in karakterler if k.is_out_of_tolerance])
        
        for karakter in karakterler:
            if karakter.actual and not karakter.is_out_of_tolerance:  # Uygunsuz iÅŸaretli deÄŸilse
                tolerance_results, _ = self.check_multiple_values_tolerance(karakter.actual, karakter)
                
                if tolerance_results:
                    if not all(tolerance_results):
                        tolerance_violations += 1
                    else:
                        tolerance_compliant += 1
                else:
                    no_tolerance_defined += 1
        
        return {
            'total': total,
            'measured': measured,
            'unmeasured': unmeasured,
            'completion_percentage': (measured / total * 100) if total > 0 else 0,
            'tolerance_violations': tolerance_violations,
            'tolerance_compliant': tolerance_compliant,
            'no_tolerance_defined': no_tolerance_defined,
            'unsuitable_markings': unsuitable_markings  # Yeni eklenen
        }
